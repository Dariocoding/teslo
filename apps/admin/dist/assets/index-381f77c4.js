import{j as e,P as g,h as o,q as v,n as p,L as h,v as d,as as w,e as f,ai as y,R as m,f as B,r as C,y as E}from"./index-2a44fdcc.js";import{H as T}from"./index-a6c3125b.js";import{m as P}from"./index.esm-692625f4.js";import{u as S}from"./useFetchBill-068ac2b4.js";import{E as D}from"./EnterpriseInfo-84e59df8.js";import{t as r}from"./translate-b34db3f3.js";import{B as Y}from"./BadgeStatusOrder-f546f70b.js";import{T as k}from"./index.esm-53628aa7.js";import{S as b}from"./sweetalert2.all-46b1fbb2.js";import{T as F}from"./TablePlaceholder-9eafa574.js";import"./index-503cc3cd.js";import"./emotion-is-prop-valid.esm-9ab032ed.js";import"./index-bc927370.js";import"./useQueryState-c63bf4c4.js";import"./capitalize-1790f93b.js";const H=a=>{var l,t;const{bill:s}=a;return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:r("products.single")}),e.jsx("th",{className:"text-center",children:r("bills.label.qty")}),e.jsx("th",{className:"text-center",children:r("products.label.price")}),e.jsx("th",{className:"text-center",children:r("bills.label.subtotal")})]})}),e.jsx("tbody",{children:(t=(l=s.details)==null?void 0:l.map)==null?void 0:t.call(l,(i,n)=>{var c,x;return e.jsxs("tr",{children:[e.jsx("td",{className:"",children:e.jsxs("div",{className:"flex items-center print:block print:max-w-[200px]",children:[e.jsx("div",{className:"flex-shrink-0 items-center print:hidden",children:e.jsx("img",{className:"h-12 w-12 rounded-md",src:g+"/product/"+((c=i.product)==null?void 0:c.images[0]),alt:""})}),e.jsx("div",{className:"ml-1 print:ml-0",children:e.jsx("div",{className:"text-sm font-medium text-gray-900 print:whitespace-normal",children:(x=i.product)==null?void 0:x.title})})]})}),e.jsx("td",{className:"text-center",children:i.qty}),e.jsx("td",{className:"text-center",children:o.format(i.price)}),e.jsx("td",{className:"text-center",children:o.format(i.price*i.qty)})]},n)})}),e.jsxs("tfoot",{children:[e.jsxs("tr",{children:[e.jsxs("td",{colSpan:3,className:"text-right font-bold",children:[r("bills.label.subtotal"),":"]}),e.jsx("td",{className:"text-center",children:o.format(s.subtotal)})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:3,className:"text-right font-bold",children:"I.V.A:"}),e.jsxs("td",{className:"text-center",children:[s.tax," %"]})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:3,className:"text-right font-bold",children:r("bills.label.deliveryPrice")}),e.jsx("td",{className:"text-center",children:o.format(s.delivery)})]}),e.jsxs("tr",{children:[e.jsxs("td",{colSpan:3,className:"text-right font-bold",children:[r("bills.label.total"),":"]}),e.jsx("td",{className:"text-center",children:o.format(s.total)})]})]})]})})},I=a=>{var n,c,x,j;const{bill:s,setBill:l}=a,{formatMessage:t}=v(),i=()=>{b.fire({title:t({id:"bills.delete.youSure"}),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes",cancelButtonText:"No",reverseButtons:!0}).then(async u=>{if(u.isConfirmed){const N=await B.billsService.updateBill(s.idbill,{status:f.ValidStatusOrder.CANCELED});l({...N.data}),b.fire(t({id:"app.canceled"}),t({id:"bills.delete.success"}),"success")}})};return e.jsxs("div",{className:"tile p-0 max-w-[900px] mx-auto",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsx(D,{})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h6",{className:"font-semibold text-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-xl",children:t({id:"bills.single"})})," ",e.jsx(Y,{full:!1,status:s.status,className:"px-2 py-0.5 rounded-md text-[10px] mb-0 ml-1.5"})]})}),e.jsxs("div",{className:"flex lg:items-center items-start justify-start lg:justify-between lg:mt-1 print:justify-between print:flex-row lg:flex-row flex-col",children:[e.jsxs("div",{className:"text-xs",children:[e.jsx("strong",{children:"ID:"})," ",s.idbill]}),e.jsxs("div",{className:"text-xs",children:[e.jsxs("strong",{children:[t({id:"bills.label.reference"}),":"]})," ",s.reference||"No reference"]})]}),e.jsxs("div",{className:"flex lg:items-center items-start justify-start lg:justify-between lg:mt-1 print:justify-between print:flex-row lg:flex-row flex-col",children:[e.jsxs("div",{className:"text-xs",children:[e.jsxs("strong",{children:[t({id:"bills.label.dateCreated"}),":"]})," ",p(s.dateCreated).format("DD/MM/YYYY HH:mm")]}),e.jsxs("div",{className:"text-xs",children:[e.jsxs("strong",{children:[t({id:"bills.label.dateUpdated"}),":"]})," ",p(s.dateUpdated).format("DD/MM/YYYY HH:mm")]})]})]}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-semibold text-lg",children:"Provider"}),e.jsxs("div",{className:"flex items-start justify-start lg:gap-1 mt-1 flex-col print:flex-row print:flex-wrap print:justify-between",children:[e.jsxs("div",{className:"flex print:justify-between print:flex-row lg:items-center items-start justify-start lg:justify-between w-full lg:flex-row flex-col text-xs",children:[e.jsxs("div",{children:[e.jsxs("strong",{children:[t({id:"providers.label.name"}),":"]})," ",(n=s==null?void 0:s.provider)==null?void 0:n.name]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[t({id:"providers.label.email"}),":"]})," ",(c=s==null?void 0:s.provider)==null?void 0:c.email]})]}),e.jsxs("div",{className:"flex print:justify-between print:flex-row lg:items-center items-start justify-start lg:justify-between w-full lg:flex-row flex-col text-xs",children:[e.jsxs("div",{children:[e.jsxs("strong",{children:[t({id:"providers.label.phone1"}),":"]})," ",(x=s==null?void 0:s.provider)==null?void 0:x.phone1]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[t({id:"providers.label.phone2"}),":"]})," ",(j=s==null?void 0:s.provider)==null?void 0:j.phone2]})]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(H,{bill:s})}),e.jsxs("div",{className:"mt-4 print:hidden",children:[e.jsxs("div",{className:"flex items-center justify-between gap-x-1",children:[e.jsxs(h,{to:d.editBill.fnPath(s.idbill),className:"btn btn-primary btn-sm w-full",children:[t({id:"app.edit"})," ",e.jsx(w,{className:"ml-1"})]}),e.jsxs("button",{type:"button",disabled:s.status===f.ValidStatusOrder.CANCELED,onClick:i,className:"btn btn-danger btn-sm w-full mr-0",children:[t({id:"app.delete"}),e.jsx(k,{className:"ml-1"})]})]}),e.jsxs("button",{type:"button",onClick:()=>window.print(),className:"w-full btn btn-warning btn-xs lg:flex hidden",children:[t({id:"app.exportPdf"})," ",e.jsx(y,{className:"ml-1"})]})]}),e.jsx(m,{isTrue:s.description,children:e.jsx("div",{className:"mt-4 print:hidden",children:e.jsxs("div",{children:[e.jsx("h6",{className:"font-semibold text-lg",children:t({id:"bills.label.description"})}),e.jsx("p",{className:"text-xs",children:s.description})]})})})]})]})},L=a=>{const{isLoading:s,error:l}=a;return e.jsxs(C.Fragment,{children:[e.jsx(m,{isTrue:s,children:e.jsx("div",{className:"tile max-w-[900px] mx-auto",children:e.jsx(F,{})})}),e.jsxs(m,{isTrue:!s,children:[e.jsx(m,{isTrue:l,children:e.jsxs("div",{className:"tile",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{children:e.jsx("img",{src:"/img/others/error.png",alt:"Error message",className:"w-28 mx-auto"})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Error"}),e.jsx("p",{children:"There was an error while fetching the bill"})]})]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(h,{to:d.bills.path,className:"btn btn-sm btn-primary mt-4",children:"Go back"})})]})}),e.jsx(m,{isTrue:!l,children:a.children})]})]})},Z=a=>{const{id:s}=E(),{data:l,isFetching:t,error:i,setData:n}=S(s);return e.jsx(T,{to:d.bills.path,breadcrumbs:[{to:d.dashboard.path,label:r("dashboard.title")},{to:d.bills.path,label:r("bills.title")},{label:r("bills.view.title")}],title:r("bills.view.title"),icon:e.jsx(P,{}),children:e.jsx(L,{isLoading:t,error:i,children:Object.keys(l||{}).length===0?e.jsxs("div",{className:"tile max-w-[1000px] mx-auto",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{children:e.jsx("img",{src:"/img/others/error.png",alt:"Error message",className:"w-28 mx-auto"})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Error"}),e.jsx("p",{children:"404 Bill not found"})]})]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(h,{to:d.bills.path,className:"btn btn-sm btn-primary mt-4",children:"Go back"})})]}):e.jsx(I,{bill:l,setBill:n})})})};export{Z as default};
