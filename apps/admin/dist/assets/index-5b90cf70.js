import{r as N,a as F,j as e,o as I,U as Ne,V as ve,R as z,c as B,t as de,e as ue,P as we,h as L,L as te,v as W,W as me,q as R,Q as H,_ as O,S as G,f as E,T as Q,X as xe,D as Ce,Y as ee,Z as Y,z as Se,d as ae,E as ke,$ as Z,a0 as qe,m as ze,a1 as Te,a2 as U,s as Me,l as Ae,a3 as Pe,a4 as re,a5 as Oe,J as he,g as Ve,b as Fe}from"./index-3ba1a706.js";import{g as De,u as fe,F as Ee,a as Le}from"./formik.esm-082975a3.js";import{D as Be,S as Ie}from"./index-a9dc5565.js";import{t as j}from"./translate-092d59f9.js";import{R as Re}from"./react-paginate-dac8dd77.js";import{u as Ze}from"./useMedia-ab89cd6a.js";import He from"./index-4083717d.js";import"./index-afbcf810.js";import"./react-tooltip.min-e79f5625.js";/* empty css                */import{T as pe}from"./TablePlaceholder-35369399.js";import{u as Ue}from"./useFetchUsers-b9059484.js";import{_ as K}from"./slicedToArray-efe1abbd.js";import{P as V}from"./index-6654b9c9.js";import{s as _e,_ as $e}from"./index-a1d8defb.js";import{a as Ge}from"./index.esm-af88f2b7.js";import{S as J}from"./sweetalert2.all-6afdc543.js";import{N as X,I as Qe}from"./index-e73b124f.js";import{b as Ye,c as Je}from"./index.esm-b422dff9.js";import{u as Ke}from"./useFetchPaymentMethods-8dcf615f.js";import{A as We}from"./ActionsTableOrder-0ba68a93.js";import{B as Xe}from"./BadgeStatusOrder-2a4a99b5.js";import ge from"./FormUser-8b54ffcb.js";import{L as _}from"./label-7eeebea1.js";import{D as es,a as ne}from"./DropdownItem-3f2e4d6d.js";import"./index-c8ae6f07.js";import{s as ss}from"./styled-components.browser.esm-f45d86a5.js";import{u as je}from"./useFirstLoad-5784d01c.js";var ie,ts=_e.div(ie||(ie=$e([`
    animation: `,` 250ms forwards;
    overflow: hidden;
    `,`

    @keyframes fadeIn {
        from {
            opacity: 0;
        }

        to {
            opacity: 1;
        }
    }

    @keyframes fadeOut {
        from {
            opacity: 1;
        }

        to {
            opacity: 0;
        }
    }

    @keyframes slideVerticalIn {
        from {
            max-height: 0;
        }

        to {
            max-height: `,`px;
        }
    }

    @keyframes slideVerticalOut {
        from {
            max-height: `,`px;
        }

        to {
            max-height: 0;
        }
    }

    @keyframes slideHorizontalIn {
        from {
            max-width: 0;
        }

        to {
            max-width: `,`px;
        }
    }

    @keyframes slideHorizontalOut {
        from {
            max-width: `,`px;
        }

        to {
            max-width: 0;
        }
    }
`])),function(a){return a.animation},function(a){return!a.isVisible&&"display: none;"},function(a){return a.dimensions?a.dimensions.height:9999},function(a){return a.dimensions?a.dimensions.height:9999},function(a){return a.dimensions?a.dimensions.width:9999},function(a){return a.dimensions?a.dimensions.width:9999});const as=ts;var rs=function(s){if(s){var t=s.style,n=t.position,d=t.visibility,l=t.display;s.style.position="absolute",s.style.visibility="hidden",s.style.display="block";var o=s.getBoundingClientRect();return s.style.position=n,s.style.visibility=d,s.style.display=l,o}};const ns=rs;var se=function(s){var t=s.id,n=s.className,d=s.style,l=s.isTrue,o=s.inAnimation,c=s.outAnimation,x=s.children,h=N.useState(),p=K(h,2),f=p[0],v=p[1],u=N.useState(l),g=K(u,2),r=g[0],i=g[1],m=N.useState(),w=K(m,2),y=w[0],C=w[1],A=N.useRef();N.useLayoutEffect(function(){if(l){var P=ns(A.current);C(P),i(!0),v("".concat(o,"In"))}else v("".concat(c,"Out"))},[l,o,c]);var S=function(T){T.animationName.includes("Out")&&i(!1)};return F.createElement(as,{id:t,className:n,style:d,animation:f,isVisible:r,dimensions:y,onAnimationEnd:S,ref:A},x)};se.propTypes={id:V.string,className:V.string,style:V.object,isTrue:V.any,inAnimation:V.oneOf(["fade","slideVertical","slideHorizontal"]),outAnimation:V.oneOf(["fade","slideVertical","slideHorizontal"]),children:V.oneOfType([V.arrayOf(V.node),V.object,V.node])};se.defaultProps={id:void 0,className:void 0,style:void 0,isTrue:!1,inAnimation:"fade",outAnimation:"fade",children:[]};const $=se,is=a=>{const{setQ:s,q:t}=a;return e.jsx("div",{className:"mb-2",children:e.jsx("input",{type:"text",value:t,onChange:n=>s(n.target.value),className:"form-control form-control-sm"})})},ls=a=>{const{user:s,onClickUser:t}=a,{colors:n}=I();return e.jsx("div",{className:"border border-gray-300 rounded-lg p-2 transition hover:bg-gray-200 cursor-pointer gap-x-3",onClick:()=>t(s),children:e.jsxs("div",{className:"leading-[0.85rem] text-sm space-y-3",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Full Name:"})," ",s==null?void 0:s.firstName," ",s==null?void 0:s.lastName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"DNI:"})," ",s.dni?(s.prefix&&n.enablePrefixesUser?s.prefix+" ":"")+s.dni:"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",s==null?void 0:s.email]})]})})},os=a=>{const{page:s,pageCount:t,setItemOffset:n,setPage:d,items:l,itemsPerPage:o}=a,c=x=>{const h=x.selected*o%l.length;n(h),d(x.selected)};return e.jsx(Re,{nextLabel:e.jsx(Ne,{}),onPageChange:c,pageRangeDisplayed:1,pageCount:t,previousLabel:e.jsx(ve,{}),renderOnZeroPageCount:null,pageClassName:"",pageLinkClassName:"btn shadow-none sm:block hidden btn-outline-primary btn-xs",previousClassName:"",previousLinkClassName:"btn shadow-none btn-primary btn-xs px-2",nextClassName:"",nextLinkClassName:"btn shadow-none btn-primary btn-xs px-2",breakLabel:"...",breakClassName:"btn shadow-none sm:block hidden btn-xs btn-outline-primary",breakLinkClassName:"",containerClassName:"flex justify-center items-center",activeClassName:"",activeLinkClassName:"btn shadow-none btn-primary btn-xs",forcePage:s})},cs=a=>{const{sm:s,setShowDrawerClient:t,refFetchUsers:n}=a,d=Ue(),{data:l,isLoading:o}=d,{values:c,setValues:x}=M(),h=s?5:12,[p,f]=N.useState(""),[v,u]=N.useState(0),[g,r]=N.useState(0),[i,m]=N.useState(0),[w,y]=N.useState([]);N.useEffect(()=>{(()=>{const P=i+h,T=C(l),q=Math.ceil(T.length/h),b=T.slice(i,P),k=q?v+1:0;if(y(b),r(q),k>q){const D=(q-1)*h%l.length;m(D),u(q-1)}})()},[i,l,p,s]),N.useEffect(()=>{n.current=d},[n,d]);const C=S=>{const P=S[0]&&Object.keys(S[0]);return S.filter(T=>P.some(q=>{var b,k,D;return((D=(k=(b=De(T,q))==null?void 0:b.toString())==null?void 0:k.toLowerCase())==null?void 0:D.indexOf(p.toLowerCase().trim()))>-1}))},A=S=>{x({...c,user:S}),t(!1)};return e.jsxs(N.Fragment,{children:[e.jsx(z,{isTrue:o,children:e.jsx(pe,{})}),e.jsxs(z,{isTrue:!o,children:[e.jsx(is,{q:p,setQ:f}),e.jsx("div",{className:"grid min-[750px]:grid-cols-2 gap-1.5",children:w.map(S=>e.jsx(ls,{user:S,onClickUser:A},S.iduser))}),e.jsx("div",{className:"mt-3",children:e.jsx(os,{page:v,pageCount:g,items:l,itemsPerPage:h,setPage:u,setItemOffset:m})})]})]})},ds=a=>{const{showDrawerClient:s,setShowDrawerClient:t}=a,n=N.useRef(null),{values:d,setValues:l}=M(),[o,c]=N.useState(!1),x=Ze("(max-width: 750px)"),h=x?290:750;N.useEffect(()=>{const f=v=>{const u=v.target||{};(u==null?void 0:u.nodeName)!=="INPUT"&&v.key==="c"&&t(!s)};return document.addEventListener("keydown",f),()=>{document.removeEventListener("keydown",f)}},[s]),N.useEffect(()=>{s&&c(!1)},[s]);const p=f=>{l({...d,user:f}),t(!1),n.current.setData([f,...n.current.data])};return e.jsx(He,{width:h,overlayClassName:"bg-black bg-opacity-25",shouldCloseOnOverlayClick:!1,isOpen:s,placement:"right",bodyClass:"p-3",onClose:()=>t(!1),title:e.jsxs("span",{className:"text-xl font-semibold",children:[j("users.customers")," ",e.jsxs("button",{onClick:()=>c(!o),className:B("btn btn-xs mb-0 gap-1 shadow-none ml-1",o?"btn-danger":"btn-primary"),children:[o?null:e.jsx(de,{})," ",j(o?"app.cancel":"users.action.create.customer")]})]}),children:o?e.jsx(ge,{defaultValidRole:[ue.ValidRoles.USER],renderRoles:!1,onSuccess:p,dniValidate:!0}):e.jsx(cs,{sm:x,setShowDrawerClient:t,refFetchUsers:n})})},us=a=>e.jsxs(N.Fragment,{children:[e.jsx(Be,{...a}),e.jsx(ds,{...a})]}),ms=a=>{var n,d,l,o;const{product:s,className:t}=a;return e.jsxs("div",{className:t,children:[e.jsx(z,{isTrue:!((n=s==null?void 0:s.images)!=null&&n.length),children:e.jsx("img",{src:"/img/others/box.png",className:"max-w-[100px] mx-auto rounded-lg",alt:s==null?void 0:s.title})}),e.jsx(z,{isTrue:(d=s==null?void 0:s.images)==null?void 0:d.length,children:e.jsx("div",{className:"grid grid-cols-2 gap-2",children:(o=(l=s==null?void 0:s.images)==null?void 0:l.map)==null?void 0:o.call(l,(c,x)=>e.jsx("div",{children:e.jsx("img",{src:we+"/product/"+c,alt:s==null?void 0:s.title,className:"rounded-lg mx-auto"})},x))})})]})},xs=a=>{var d,l,o,c,x,h,p;const{product:s,className:t}=a,{colors:n}=I();return e.jsxs("div",{className:t,children:[e.jsxs("h6",{className:"text-xl",children:[s==null?void 0:s.title," (",L.format((s==null?void 0:s.price)||0),")"]})," ",e.jsx(z,{isTrue:s==null?void 0:s.status,children:e.jsx("p",{className:"text-xs mt-0.5 sm:block hidden",children:s==null?void 0:s.status})}),e.jsxs("div",{className:"flex flex-col items-start gap-2.5 mt-3 text-sm",children:[e.jsxs("span",{children:[e.jsxs("strong",{children:[j("products.label.stock"),": "]})," ",s==null?void 0:s.stock]}),e.jsxs("span",{children:[e.jsxs("strong",{children:[j("products.label.code"),": "]})," ",s==null?void 0:s.code]}),e.jsxs("span",{children:[e.jsx("strong",{children:"Custom Code: "})," ",s==null?void 0:s.customCode]}),e.jsx(z,{isTrue:n.enableClothesShopping,children:e.jsxs("p",{children:[e.jsxs("span",{className:"font-bold",children:[j("products.label.sizes"),":"]})," ",(l=(d=s==null?void 0:s.sizes)==null?void 0:d.join)==null?void 0:l.call(d,", ")]})}),e.jsx(z,{isTrue:(o=s==null?void 0:s.categories)==null?void 0:o.length,children:e.jsxs("span",{className:"flex items-center gap-x-1",children:[e.jsxs("span",{className:"font-bold",children:[j("products.label.categories"),":"]})," ",e.jsx("ul",{className:"flex items-center gap-1 flex-wrap",children:(x=(c=s==null?void 0:s.categories)==null?void 0:c.map)==null?void 0:x.call(c,f=>e.jsx("li",{children:e.jsx(te,{to:W.viewCategory.fnPath(f.idcategory),className:"link-table",children:f.title})},f.idcategory))})]})}),e.jsx(z,{isTrue:s==null?void 0:s.brand,children:e.jsxs("span",{className:"flex items-center gap-x-1",children:[e.jsxs("span",{className:"font-bold",children:[j("products.label.brand"),":"]})," ",e.jsx("ul",{children:e.jsx("li",{children:e.jsx(te,{to:W.viewCategory.fnPath((h=s==null?void 0:s.brand)==null?void 0:h.idbrand),className:"link-table",children:(p=s==null?void 0:s.brand)==null?void 0:p.title})})})]})})]})]})},hs=a=>{var c;const{product:s,state:t,setState:n,className:d,handleAcceptProduct:l}=a,{colors:o}=I();return e.jsxs("div",{className:B("flex-grow",d),children:[e.jsxs("div",{className:B(o.enableClothesShopping&&"grid grid-cols-2 gap-2"),children:[e.jsx(z,{isTrue:o.enableClothesShopping,children:e.jsxs("div",{children:[e.jsx(_,{className:"text-xs",children:j("products.label.size")}),e.jsx("select",{name:"",id:"",className:"form-control sm:p-4 p-2 sm:text-sm text-xs",value:t.size,onChange:x=>n({...t,size:x.target.value}),children:(c=s==null?void 0:s.sizes)==null?void 0:c.map(x=>e.jsx("option",{value:x,className:"uppercase",children:x},x))})]})}),e.jsxs("div",{children:[e.jsx(_,{className:"text-xs",children:j("orders.label.qty")}),e.jsx(X,{allowNegative:!1,decimalScale:0,value:t.qty,className:"form-control sm:p-4 p-2 sm:text-sm text-xs",onValueChange:x=>n({...t,qty:x.floatValue})})]})]}),e.jsx("div",{children:e.jsxs("p",{className:"mt-3",children:[e.jsx("strong",{children:"Total Price:"})," ",L.format((t.qty||0)*((s==null?void 0:s.price)||0))]})}),e.jsxs("button",{type:"button",onClick:l,className:"mt-4 mb-0 btn btn-primary btn-sm mr-0 gap-2 w-full",children:[j("app.save")," ",e.jsx(me,{})]})]})},fs=a=>{const[s,t]=F.useState({size:null,qty:0}),{colors:n}=I(),{formatMessage:d}=R(),{addCart:l}=H(),{values:o,setValues:c}=M(),x=async u=>{const g=h();g&&!o.order&&await v(),g&&o.order&&f(),g&&(u==null||u())},h=()=>{if(!(a!=null&&a.id)&&!(a!=null&&a.stock))return!1;if((a==null?void 0:a.stock)<s.qty)return i(s.qty),!1;const{detailProductOrder:u,detailTempProduct:g}=p();if(g&&r(g.qty))return!1;function r(m){const w=s.qty+m;if(a.stock<w)return i(w),!0}function i(m){O.error(d({id:"orders.stockMustBeGreaterThan"},{qty:m}))}return!0},p=()=>{let u,g;return n.enableClothesShopping?(g=o.detailOrderProducts.find(r=>{var i;return((i=r.product)==null?void 0:i.id)===(a==null?void 0:a.id)&&r.size===s.size}),u=o.products.find(r=>{var i;return((i=r.product)==null?void 0:i.id)===(a==null?void 0:a.id)&&r.size===s.size})):(g=o.detailOrderProducts.find(r=>{var i;return((i=r.product)==null?void 0:i.id)===(a==null?void 0:a.id)}),u=o.products.find(r=>{var i;return((i=r.product)==null?void 0:i.id)===(a==null?void 0:a.id)})),{detailProductOrder:g,detailTempProduct:u}},f=()=>{let{detailProductOrder:u,detailTempProduct:g}=p();if(g&&u&&(c({...o,products:o.products.filter(i=>n.enableClothesShopping?i.product.id!==g.product.id&&i.size!==g.size:i.product.id!==g.product.id)}),g=null),!g&&!u){c({...o,products:[{qty:s.qty,size:s.size,id:null,product:a},...o.products]});return}u&&c({...o,detailOrderProducts:o.detailOrderProducts.map(i=>(i.product.id===u.product.id&&(i.quantity=i.quantity+s.qty),i))}),g&&c({...o,products:o.products.map(i=>(i.product.id===g.product.id&&(i.qty=i.qty+s.qty),i))}),O.success("Product added sucessfully!");const r=document.getElementById("searchProduct");r&&r.focus()},v=async()=>{try{G();const u=await E.detailTempOrdersService.create({product:a,qty:s.qty,size:s.size});if(o.products.some(r=>n.enableClothesShopping?r.product.id===(a==null?void 0:a.id)&&r.size===s.size:r.product.id===(a==null?void 0:a.id))){const r=o.products.find(i=>n.enableClothesShopping?i.product.id===(a==null?void 0:a.id)&&i.size===s.size:i.product.id===(a==null?void 0:a.id));r&&l(u.data,{size:u.data.size,qty:u.data.qty-r.qty})}else l(u.data,{size:u.data.size,qty:u.data.qty});c({...o,products:o.products.some(r=>n.enableClothesShopping?r.product.id===a.id&&r.size===s.size:r.product.id===a.id)?o.products.map(r=>(n.enableClothesShopping?r.product.id===a.id&&r.size===s.size:r.product.id===a.id)?u.data:r):[u.data,...o.products]}),O.success("Product added sucessfully!");const g=document.getElementById("searchProduct");g&&g.focus()}catch(u){console.log(u),O.error("There was an error...")}finally{Q()}};return{state:s,setState:t,addProductToStorage:x}},ps=a=>{const{onClose:s,show:t,product:n={}}=a,[d,l]=N.useState(!1),{colors:o}=I(),{setState:c,state:x,addProductToStorage:h}=fs(n),p=()=>h(s);return N.useEffect(()=>{c(n?{size:n.sizes.length&&o.enableClothesShopping?n.sizes[0]:null,qty:1}:{size:null,qty:1})},[n,o.enableClothesShopping]),N.useEffect(()=>{const f=v=>{v.key!=="Enter"||!d||p()};return document.addEventListener("keypress",f),()=>{document.removeEventListener("keypress",f)}},[p]),N.useEffect(()=>{l(t)},[t]),e.jsx(xe,{title:e.jsx("h6",{className:"sm:text-xl text-lg",children:(n==null?void 0:n.title)+` (${L.format((n==null?void 0:n.price)||0)})`}),onClose:s,showModal:t,size:"xl",children:e.jsxs("div",{className:"lg:grid lg:grid-cols-3 gap-4 lg:gap-8 flex flex-col items-start",children:[e.jsx(ms,{product:n,className:"lg:order-1 order-2"}),e.jsx("div",{className:"lg:col-span-2 lg:order-2 order-1",children:e.jsxs("div",{className:"flex flex-wrap gap-1.5 sm:gap-3 items-start",children:[e.jsx(xs,{product:n,className:"max-w-[275px]"}),e.jsx(hs,{setState:c,state:x,product:n,handleAcceptProduct:p})]})})]})})};N.lazy(()=>Ce(()=>import("./FormUser-8b54ffcb.js"),["assets/FormUser-8b54ffcb.js","assets/index-3ba1a706.js","assets/index-57a2b61b.css","assets/index-ef1fda9f.js","assets/formik.esm-082975a3.js","assets/index-e73b124f.js","assets/label-7eeebea1.js","assets/index-c8ae6f07.js","assets/index.esm-6b48a1be.js","assets/styled-components.browser.esm-f45d86a5.js","assets/emotion-is-prop-valid.esm-9ab032ed.js","assets/emotion-unitless.esm-475d8cc4.js","assets/index-4a612718.js","assets/index.esm-431b757e.js","assets/index-6ffea55d.js","assets/motion-d685a380.js","assets/index.esm-8e4abcfc.js","assets/useTimeOutMessage-9ac15e50.js","assets/translate-092d59f9.js","assets/capitalize-1790f93b.js","assets/react-paginate-dac8dd77.js","assets/index-afbcf810.js","assets/index-6654b9c9.js","assets/index-3f054690.css","assets/react-tooltip.min-e79f5625.js","assets/react-tooltip-a01a62b5.css","assets/_upload-6afe1282.css"]));const gs=()=>{var l,o;const[a,s]=F.useState(null),{formatMessage:t}=R(),n=a&&((o=(l=document.getElementById("tableTempProduct"))==null?void 0:l.contains)==null?void 0:o.call(l,a)),{colors:d}=I();return e.jsx("thead",{className:"bg-blue-600 bg-opacity-10 backdrop-filter backdrop-blur-lg",ref:s,children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 w-[130px] max-w-[130px]",children:j("products.label.code")}),e.jsx("th",{className:"px-2 py-2 w-[130px]",children:j(n?"products.single":"products.title")}),e.jsx(z,{isTrue:d.enableClothesShopping,children:e.jsxs("th",{className:B("px-2 py-2 w-[130px]","text-center"),children:[j(n?"products.label.sizes":"products.label.size")," "]})}),e.jsx("th",{className:"px-2 py-2 w-[130px] text-center",children:n?t({id:"products.label.stock"}):""}),e.jsx("th",{className:"px-2 py-2 w-[115px] text-center",children:j("products.label.price")}),e.jsx("th",{className:"px-2 py-2 w-[130px] text-center",children:j("orders.label.qty")}),e.jsx("th",{className:"px-2 py-2 w-[130px] text-center",children:j("orders.label.total")}),e.jsx("th",{className:"px-2 py-2 w-[130px] text-center",children:j(n?"orders.label.action":"orders.label.actions")})]})})};F.memo(gs);ss.div`
  .content-text {
    width: 0%;
  }

  .content-text,
  .container-icon {
    transition: width 0.5s cubic-bezier(0.17, 0.67, 1, 0.2),
      padding-left 0.5s cubic-bezier(0.17, 0.67, 1, 0.2),
      padding-right 0.5s cubic-bezier(0.17, 0.67, 1, 0.2),
      background 0.25s cubic-bezier(0.17, 0.67, 1, 0.2);
  }

  .icon:hover + .content-text,
  .content-text:hover,
  .list-statuses:hover + .container-status .content-text,
  .content-text:hover,
  .icon:hover + .content-text {
    width: 100%;
    padding-left: 0.25rem;
    padding-right: 0.25rem;
    cursor: pointer;
  }
`;const ye=()=>fe(),js=a=>{const{onSuccess:s}=a||{},t=je(),{setValues:n,values:d}=ye(),[l,o]=F.useState("");return F.useEffect(()=>{const c=ee.CancelToken.source();async function x(){const h=Y.loading("Loading...");try{if(t||(n({...d,user:null}),l.trim()===""))return;const p=await E.usersService.getUser(l,null,{cancelToken:c.token});n({...d,user:p.data}),s==null||s()}catch(p){console.log(p)}finally{Y.dismiss(h)}}return x(),()=>{c.cancel()}},[l]),{termCustomer:l,setTermCustomer:o}},ys=a=>{const{onSuccess:s}=a;ye();const t=je(),[n,d]=F.useState(null),[l,o]=F.useState([]),[c,x]=F.useState(""),[h,p]=F.useState(!1),f=()=>p(!0);function v(){var i;const r=document.getElementById("searchProduct");p(!1),(i=r==null?void 0:r.blur)==null||i.call(r),o([]),r&&(r.tabIndex=-1)}return F.useEffect(()=>{const r=ee.CancelToken.source();async function i(){var w;let m;try{if(o([]),p(!0),!((w=c==null?void 0:c.trim)!=null&&w.call(c)))return;m=Y.loading("Loading...");const y=await E.productsService.search(c,{cancelToken:r.token},{optimize:!0}),C=y.data,A=C.length>0;if(A&&d(null),A){if(+c>0){const S=y.data.sort((P,T)=>P.code===+c?-1:1);d({value:S[0].id,label:S[0].title}),o(S)}+c==0&&d({value:C[0].id,label:C[0].title})}o(y.data)}catch(y){console.log(y)}finally{Y.dismiss(m)}}return t||i(),()=>{r.cancel()}},[c]),{termProduct:c,setTermProduct:x,listProducts:l,selected:n,setSelected:d,onClickResult:r=>{const i=l.find(m=>m.id===r);i&&(s==null||s(i),x(""),v())},onFocus:f,onBlur:r=>{const i=m=>{var y,C;const w=m.target;(C=(y=document.querySelector(".container-input-code"))==null?void 0:y.contains)!=null&&C.call(y,w)||(document.removeEventListener("click",i),p(!1),o([]))};document.addEventListener("click",i)},focused:h}},bs=a=>{const{toggleDrawerCustomer:s,toggleDrawerProducts:t,setTempProduct:n}=a,{termCustomer:d,setTermCustomer:l}=js({}),c=ys({onSuccess:f=>{n(f)}}),{listProducts:x,termProduct:h,setTermProduct:p}=c;return e.jsxs(N.Fragment,{children:[e.jsxs("div",{className:"flex items-center relative",children:[e.jsx("span",{className:"text-xs py-2 pl-2.5 pr-2 rounded-l-lg shadow border border-gray-300 bg-gray-200 flex-grow h-[38px] sm:h-[34px] flex items-center justify-center",children:e.jsx(Se,{})}),e.jsx("input",{className:"form-control form-control-sm pr-9 rounded-l-none",placeholder:j("users.customer"),value:d,onChange:f=>l(f.target.value)}),e.jsx("span",{className:"top-2 right-3 absolute cursor-pointer",onClick:s,children:e.jsx(ae,{className:"text-gray-400 transition hover:text-gray-900"})})]}),e.jsx(Ie,{...c,classNameContainer:"min-w-[300px] search-list-products",results:x.map(f=>({label:`${f.title} - (${f.code})`,value:f.id})),children:e.jsxs("div",{className:"flex items-center relative",children:[e.jsx("span",{className:"text-xs py-2 pl-2.5 pr-2 rounded-l-lg shadow border border-gray-300 bg-gray-200 flex-grow h-[38px] sm:h-[34px] flex items-center justify-center",children:e.jsx(ke,{})}),e.jsx("input",{className:"form-control form-control-sm rounded-l-none pr-9",placeholder:j("products.single"),value:h,onChange:f=>p(f.target.value)}),e.jsx("span",{className:"top-2 right-3 absolute cursor-pointer",onClick:t,children:e.jsx(ae,{className:"text-gray-400 transition hover:text-gray-900"})})]})})]})},Ns=a=>{const[s,t]=N.useState(null),[n,d]=N.useState(!1),[l,o]=N.useState(!1),c=()=>d(!n),x=()=>o(!l),h=p=>{d(!1),t(p)};return e.jsxs("div",{className:"grid md:grid-cols-2 gap-2.5",children:[e.jsx(bs,{toggleDrawerCustomer:x,toggleDrawerProducts:c,setTempProduct:t}),e.jsx(us,{showDrawerClient:l,showDrawerProducts:n,setShowDrawerClient:o,setShowDrawerProducts:d,onClickProductDrawer:h}),e.jsx(ps,{show:!!s,product:s,onClose:()=>t(null)})]})},le=a=>{const{value:s,className:t,isSelected:n,onClick:d}=a;return e.jsxs("div",{className:B("md:text-base relative text-sm rounded-lg md:py-3 px-6 flex-grow transition shadow-md border-gray-300 border md:h-12 h-10 text-center flex items-center justify-center bg-gray-200",t),onClick:d,children:[a.children,e.jsxs($,{isTrue:n,children:[e.jsx("div",{className:"absolute -top-0.5 left-0 w-full h-full flex justify-start items-start",children:e.jsx(Z,{className:"rotate- text-blue-600 text-base ml-2.5 shadow-2xl shadow-teal-600"})}),e.jsx("div",{className:"absolute -top-0.5 left-0 w-full h-full flex justify-end items-start",children:e.jsx(Z,{className:"rotate- text-blue-600 text-base mr-2.5 shadow-2xl shadow-teal-600"})})]})]})},vs=[0,5,10,15,20],ws=a=>{const{className:s}=a,{values:t,setValues:n}=M(),d=l=>{n({...t,discount:l})};return e.jsxs("div",{className:B(s),children:[e.jsx(le,{value:0,className:"font-bold",children:e.jsxs("div",{className:"flex gap-1 items-center text-xs",children:[e.jsx("span",{children:e.jsx(qe,{})}),e.jsxs("span",{className:"text-sm",children:[j("orders.label.discount"),":"]})]})}),vs.map(l=>e.jsxs(le,{isSelected:t.discount===l,value:l,className:"cursor-pointer hover:bg-gray-100",onClick:()=>d(l),children:[l," %"]},l))]})},Cs=a=>{const{className:s}=a,{formatMessage:t}=R(),{values:n,setValues:d,submitForm:l}=M(),{clean:o}=H(),c=async()=>{(await J.fire({title:t({id:"orders.form.delete.temporalProducts"}),text:t({id:"app.areYouSureToDoThis"}),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes",cancelButtonText:"No",reverseButtons:!0})).isConfirmed&&(await o(),d({...n,products:[]}))};return e.jsxs("div",{className:s,children:[e.jsx(z,{isTrue:!n.order,children:e.jsx("div",{className:"w-full max-w-[50%]",children:e.jsxs("button",{type:"button",onClick:c,className:"btn w-full btn-danger gap-2.5 btn-sm",children:[e.jsx(ze,{})," ",j("app.delete")]})})}),e.jsx("div",{className:B("w-full",!n.order&&"max-w-[50%]"),children:e.jsxs("button",{className:"btn btn-success gap-2.5 btn-sm w-full",type:"button",onClick:l,children:[e.jsx(Te,{})," ",j("app.pay")]})})]})},oe=a=>{const{className:s,classNameBg:t,selectedPaymentMethod:n,paymentMethod:d,onClick:l}=a,o=n&&(n==null?void 0:n.idpaymentmethod)===(d==null?void 0:d.idpaymentmethod),{values:c,setValues:x}=M(),h=()=>{d&&x({...c,paymentMethod:d})};return e.jsxs("div",{className:B("rounded-lg text-sm py-4 sm:py-6 sm:px-8 px-4 overflow-hidden shadow-md flex-grow transition duration-300 text-white md:h-12 h-10 text-center flex items-center justify-center ",!o&&s,!o&&(t||"bg-teal-600"),o&&"relative bg-blue-700 cursor-pointer font-bold uppercase"),onClick:l||h,children:[a.children,e.jsxs($,{isTrue:o,children:[e.jsx("div",{className:"absolute -top-0.5 left-0 w-full h-full flex justify-start items-start",children:e.jsx(Z,{className:"rotate- text-white text-base ml-2.5 shadow-2xl shadow-teal-600"})}),e.jsx("div",{className:"absolute -top-0.5 left-0 w-full h-full flex justify-end items-start",children:e.jsx(Z,{className:"rotate- text-white text-base mr-2.5 shadow-2xl shadow-teal-600"})})]})]})},Ss=a=>{const{className:s,paymentMethods:t}=a,{values:n}=M(),{paymentMethod:d}=n;return e.jsxs("div",{className:s,children:[e.jsx(oe,{className:"font-bold sm:min-w-[300px]",classNameBg:"bg-blue-600",children:e.jsxs("div",{className:"flex gap-1 items-center text-base",children:[e.jsx("span",{children:e.jsx(Ye,{})}),e.jsxs("span",{className:"text-sm",children:[j("paymentMethods.title"),":"]})]})}),t.map(l=>e.jsx(oe,{className:"uppercase font-bold cursor-pointer hover:bg-teal-700",selectedPaymentMethod:d,paymentMethod:l,children:l.title},l.idpaymentmethod))]})};function mt(a){return U({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216,96v96a8,8,0,0,1-8,8H48a8,8,0,0,1-8-8V96Z",opacity:"0.2"}},{tag:"path",attr:{d:"M224,48H32A16,16,0,0,0,16,64V88a16,16,0,0,0,16,16v88a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V104a16,16,0,0,0,16-16V64A16,16,0,0,0,224,48ZM208,192H48V104H208ZM224,88H32V64H224V88ZM96,136a8,8,0,0,1,8-8h48a8,8,0,0,1,0,16H104A8,8,0,0,1,96,136Z"}}]})(a)}function ks(a){return U({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M208,32V192H72a24,24,0,0,0-24,24V56A24,24,0,0,1,72,32h40v96l32-24,32,24V32Z",opacity:"0.2"}},{tag:"path",attr:{d:"M208,24H72A32,32,0,0,0,40,56V224a8,8,0,0,0,8,8H192a8,8,0,0,0,0-16H56a16,16,0,0,1,16-16H208a8,8,0,0,0,8-8V32A8,8,0,0,0,208,24ZM120,40h48v72L148.79,97.6a8,8,0,0,0-9.6,0L120,112Zm80,144H72a31.82,31.82,0,0,0-16,4.29V56A16,16,0,0,1,72,40h32v88a8,8,0,0,0,12.8,6.4L144,114l27.21,20.4A8,8,0,0,0,176,136a8.1,8.1,0,0,0,3.58-.84A8,8,0,0,0,184,128V40h16Z"}}]})(a)}function qs(a){return U({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M152,128a24,24,0,1,1-24-24A24,24,0,0,1,152,128ZM48,104a24,24,0,1,0,24,24A24,24,0,0,0,48,104Zm160,0a24,24,0,1,0,24,24A24,24,0,0,0,208,104Z",opacity:"0.2"}},{tag:"path",attr:{d:"M128,96a32,32,0,1,0,32,32A32,32,0,0,0,128,96Zm0,48a16,16,0,1,1,16-16A16,16,0,0,1,128,144ZM48,96a32,32,0,1,0,32,32A32,32,0,0,0,48,96Zm0,48a16,16,0,1,1,16-16A16,16,0,0,1,48,144ZM208,96a32,32,0,1,0,32,32A32,32,0,0,0,208,96Zm0,48a16,16,0,1,1,16-16A16,16,0,0,1,208,144Z"}}]})(a)}function zs(a){return U({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M221.66,90.34,192,120,136,64l29.66-29.66a8,8,0,0,1,11.31,0L221.66,79A8,8,0,0,1,221.66,90.34Z",opacity:"0.2"}},{tag:"path",attr:{d:"M227.32,73.37,182.63,28.69a16,16,0,0,0-22.63,0L36.69,152A15.86,15.86,0,0,0,32,163.31V208a16,16,0,0,0,16,16H216a8,8,0,0,0,0-16H115.32l112-112A16,16,0,0,0,227.32,73.37ZM48,163.31l88-88L180.69,120l-88,88H48Zm144-54.62L147.32,64l24-24L216,84.69Z"}}]})(a)}function Ts(a){return U({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M232,128c0,12.51-17.82,21.95-22.68,33.69-4.68,11.32,1.42,30.65-7.78,39.85s-28.53,3.1-39.85,7.78C150,214.18,140.5,232,128,232s-22-17.82-33.69-22.68c-11.32-4.68-30.65,1.42-39.85-7.78s-3.1-28.53-7.78-39.85C41.82,150,24,140.5,24,128s17.82-22,22.68-33.69C51.36,83,45.26,63.66,54.46,54.46S83,51.36,94.31,46.68C106.05,41.82,115.5,24,128,24S150,41.82,161.69,46.68c11.32,4.68,30.65-1.42,39.85,7.78s3.1,28.53,7.78,39.85C214.18,106.05,232,115.5,232,128Z",opacity:"0.2"}},{tag:"path",attr:{d:"M225.86,102.82c-3.77-3.94-7.67-8-9.14-11.57-1.36-3.27-1.44-8.69-1.52-13.94-.15-9.76-.31-20.82-8-28.51s-18.75-7.85-28.51-8c-5.25-.08-10.67-.16-13.94-1.52-3.56-1.47-7.63-5.37-11.57-9.14C146.28,23.51,138.44,16,128,16s-18.27,7.51-25.18,14.14c-3.94,3.77-8,7.67-11.57,9.14C88,40.64,82.56,40.72,77.31,40.8c-9.76.15-20.82.31-28.51,8S41,67.55,40.8,77.31c-.08,5.25-.16,10.67-1.52,13.94-1.47,3.56-5.37,7.63-9.14,11.57C23.51,109.72,16,117.56,16,128s7.51,18.27,14.14,25.18c3.77,3.94,7.67,8,9.14,11.57,1.36,3.27,1.44,8.69,1.52,13.94.15,9.76.31,20.82,8,28.51s18.75,7.85,28.51,8c5.25.08,10.67.16,13.94,1.52,3.56,1.47,7.63,5.37,11.57,9.14C109.72,232.49,117.56,240,128,240s18.27-7.51,25.18-14.14c3.94-3.77,8-7.67,11.57-9.14,3.27-1.36,8.69-1.44,13.94-1.52,9.76-.15,20.82-.31,28.51-8s7.85-18.75,8-28.51c.08-5.25.16-10.67,1.52-13.94,1.47-3.56,5.37-7.63,9.14-11.57C232.49,146.28,240,138.44,240,128S232.49,109.73,225.86,102.82Zm-11.55,39.29c-4.79,5-9.75,10.17-12.38,16.52-2.52,6.1-2.63,13.07-2.73,19.82-.1,7-.21,14.33-3.32,17.43s-10.39,3.22-17.43,3.32c-6.75.1-13.72.21-19.82,2.73-6.35,2.63-11.52,7.59-16.52,12.38S132,224,128,224s-9.15-4.92-14.11-9.69-10.17-9.75-16.52-12.38c-6.1-2.52-13.07-2.63-19.82-2.73-7-.1-14.33-.21-17.43-3.32s-3.22-10.39-3.32-17.43c-.1-6.75-.21-13.72-2.73-19.82-2.63-6.35-7.59-11.52-12.38-16.52S32,132,32,128s4.92-9.15,9.69-14.11,9.75-10.17,12.38-16.52c2.52-6.1,2.63-13.07,2.73-19.82.1-7,.21-14.33,3.32-17.43S70.51,56.9,77.55,56.8c6.75-.1,13.72-.21,19.82-2.73,6.35-2.63,11.52-7.59,16.52-12.38S124,32,128,32s9.15,4.92,14.11,9.69,10.17,9.75,16.52,12.38c6.1,2.52,13.07,2.63,19.82,2.73,7,.1,14.33.21,17.43,3.32s3.22,10.39,3.32,17.43c.1,6.75.21,13.72,2.73,19.82,2.63,6.35,7.59,11.52,12.38,16.52S224,124,224,128,219.08,137.15,214.31,142.11ZM173.66,98.34a8,8,0,0,1,0,11.32l-56,56a8,8,0,0,1-11.32,0l-24-24a8,8,0,0,1,11.32-11.32L112,148.69l50.34-50.35A8,8,0,0,1,173.66,98.34Z"}}]})(a)}function Ms(a){return U({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M224,128a95.76,95.76,0,0,1-31.8,71.37A72,72,0,0,0,128,160a40,40,0,1,0-40-40,40,40,0,0,0,40,40,72,72,0,0,0-64.2,39.37h0A96,96,0,1,1,224,128Z",opacity:"0.2"}},{tag:"path",attr:{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24ZM74.08,197.5a64,64,0,0,1,107.84,0,87.83,87.83,0,0,1-107.84,0ZM96,120a32,32,0,1,1,32,32A32,32,0,0,1,96,120Zm97.76,66.41a79.66,79.66,0,0,0-36.06-28.75,48,48,0,1,0-59.4,0,79.66,79.66,0,0,0-36.06,28.75,88,88,0,1,1,131.52,0Z"}}]})(a)}const As=a=>{var v,u,g,r;const{formatMessage:s}=R(),{setModal:t,closeModal:n}=Me(),{colors:d}=I(),[l,o]=N.useState([]),[c,x]=N.useState(!0),{values:h,setValues:p}=M();N.useEffect(()=>{var w;const i=ee.CancelToken.source();async function m(){const y=h.user.iduser;try{x(!0);const C=await E.ordersService.getOrdersByIdUser(y,{take:3},{cancelToken:i.token});o(C.data)}catch(C){console.log(C)}finally{x(!1)}}return(w=h==null?void 0:h.user)!=null&&w.iduser?m():(o([]),x(!1)),()=>{i.cancel()}},[h.user]);const f=()=>{function i(m){p({...h,user:m}),n()}t({title:s({id:"users.edit"}),children:e.jsx(ge,{user:h.user,defaultValidRole:[ue.ValidRoles.USER],dniValidate:!0,onSuccess:i}),size:"md"})};return e.jsxs("div",{className:"flex items-start gap-4 md:flex-row flex-col",children:[e.jsxs("div",{className:"flex items-start gap-3 xl:min-w-[350px] flex-wrap",children:[e.jsxs("div",{children:[e.jsx(Ms,{className:"text-7xl"}),e.jsx($,{isTrue:h.user,children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("button",{type:"button",onClick:f,className:"btn btn-xs btn-success mb-0",children:e.jsx(Ae,{})})})})]}),e.jsxs("div",{className:"max-w-[325px]",children:[e.jsx("h5",{children:h.user?((v=h.user)==null?void 0:v.firstName)+" "+((u=h.user)==null?void 0:u.lastName):"-"}),e.jsxs("p",{className:"text-sm font-bold mb-2",children:[j("orders.label.clientData"),":"]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[j("users.label.dni"),": "]}),h.user&&h.user.dni?(h.user.prefix&&d.enablePrefixesUser?h.user.prefix+" ":"")+h.user.dni:"-"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[j("users.label.email"),": "]}),h.user?(g=h.user)==null?void 0:g.email:"-"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[j("users.label.phone"),": "]}),h.user?h.user.phone:"-"]})]})]})]}),e.jsxs("div",{className:"flex-grow border md:w-auto w-full border-gray-200 rounded-md overflow-auto",children:[e.jsxs(z,{isTrue:!c,children:[e.jsx(z,{isTrue:l.length,children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-center",children:j("orders.label.seller")}),e.jsx("th",{className:"text-center",children:j("orders.label.total")}),e.jsx("th",{className:"text-center md:table-cell hidden",children:j("orders.label.status")}),e.jsx("th",{className:"text-center md:table-cell hidden",children:j("orders.label.actions")})]})}),e.jsx("tbody",{children:(r=l==null?void 0:l.map)==null?void 0:r.call(l,i=>{var m,w;return e.jsxs("tr",{children:[e.jsx("td",{className:"text-center whitespace-normal",children:((m=i.userSell)==null?void 0:m.firstName)+" "+((w=i.userSell)==null?void 0:w.lastName)}),e.jsx("td",{className:"text-center",children:L.format(i.total||0)}),e.jsx("td",{className:"text-center md:table-cell hidden",children:e.jsx(Xe,{status:i.status,className:"mb-0 shadow-none"})}),e.jsx("td",{className:"text-center md:table-cell hidden",children:e.jsx(We,{order:i})})]},i.idorder)})})]})}),e.jsx(z,{isTrue:!l.length,children:e.jsxs("div",{className:"py-3",children:[e.jsx("h6",{className:"font-light text-center mb-2",children:"Orders empty"}),e.jsx("div",{children:e.jsx("img",{src:"/img/others/pending-approval.png",className:"mx-auto w-36",alt:""})})]})})]}),e.jsx(z,{isTrue:c,children:e.jsx(pe,{className:"pt-4",classNameEachRow:"h-2 bg-teal-300"})})]})]})},Ps=a=>{var f,v,u,g;const{product:s,productOrder:t}=a,{setCart:n,cart:d}=H(),{values:l,setValues:o}=M(),{colors:c}=I(),x=()=>{if(s){if(o({...l,products:l.products.map(r=>{if(r.id===s.id&&r.size===s.size){const i=s.qty-1;if(i<=0)return r;r.qty=i}return r})}),n(d.map(r=>({...r,qty:r.id===s.id&&r.size===s.size?r.qty-1<=0?1:r.qty-1:r.qty,sameQty:r.id===s.id&&r.size===s.size?r.qty-1<=0?1:r.qty-1:r.qty,size:(r.id===s.id&&r.size===s.size,r.size)}))),s.qty-1===0)return;E.detailTempOrdersService.updateOne(s.id,{qty:s.qty-1,...s.size&&{size:s.size}})}t&&o({...l,detailOrderProducts:l.detailOrderProducts.map(r=>{if(r.id===t.id&&r.size===t.size){const i=t.quantity-1;r.quantity=i}return r})})},h=()=>{if(s){if(s.qty+1>s.product.stock)return O.error("No hay suficiente stock");o({...l,products:l.products.map(r=>{if(r.id===s.id&&r.size===s.size){const i=s.qty+1;if(i<=0||i>r.product.stock)return r;r.qty=i}return r})}),n(d.map(r=>({...r,qty:r.id===s.id&&r.size===s.size?r.qty+1:r.qty,sameQty:r.id===s.id&&r.size===s.size?r.qty+1:r.qty,size:(r.id===s.id&&r.size===s.size,r.size)}))),E.detailTempOrdersService.updateOne(s.id,{qty:s.qty+1,...s.size&&{size:s.size}})}t&&o({...l,detailOrderProducts:l.detailOrderProducts.map(r=>{if(r.id===t.id&&r.size===t.size){const i=t.quantity+1;r.quantity=i}return r})})},p=r=>{s&&o({...l,products:l.products.map(i=>(i.id===s.id&&i.size===s.size&&(i.size=r.target.value),i))}),t&&o({...l,detailOrderProducts:l.detailOrderProducts.map(i=>(i.id===t.id&&i.size===t.size&&(i.size=r.target.value),i))})};return e.jsxs("div",{className:"flex items-center mt-2 gap-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{onClick:x,className:"p-2 bg-gray-200 rounded-l-md h-[30px] group hover:bg-gray-300 transition duration-300 cursor-pointer",children:e.jsx(Pe,{className:"text-gray-600 text-xs group-hover:text-black transition duration-300"})}),e.jsx("div",{className:"p-2 bg-gray-100 max-h-max h-[30px] flex items-center",children:(s==null?void 0:s.qty)||(t==null?void 0:t.quantity)}),e.jsx("div",{onClick:h,className:"p-2 bg-gray-200 rounded-r-md h-[30px] group hover:bg-gray-300 transition duration-300 cursor-pointer",children:e.jsx(de,{className:"text-gray-600 text-xs group-hover:text-black transition duration-300"})})]}),e.jsx(z,{isTrue:c.enableClothesShopping&&((s==null?void 0:s.size)||(t==null?void 0:t.size)),children:e.jsx("div",{children:e.jsx("select",{className:"form-control form-control-sm shadow-none",onChange:p,value:(s==null?void 0:s.size)||(t==null?void 0:t.size),children:(g=(u=((f=s==null?void 0:s.product)==null?void 0:f.sizes)||((v=t==null?void 0:t.product)==null?void 0:v.sizes))==null?void 0:u.map)==null?void 0:g.call(u,r=>e.jsx("option",{value:r,children:r},r))})})})]})},be=a=>{const{showModal:s,onClose:t,detail:n,isDetailOrderAction:d,isProductAction:l}=a,o={price:(n==null?void 0:n.total)??(n==null?void 0:n.price)??0,qty:(n==null?void 0:n.quantity)??(n==null?void 0:n.qty)??1,title:(n==null?void 0:n.title)??""},{formatMessage:c}=R(),{addCart:x,setCart:h,cart:p}=H(),{values:f,setValues:v}=M(),[u,g]=N.useState(o);N.useEffect(()=>{s&&g(o)},[s]);const r=async()=>{const i=!!n;if(!u.title)return O.error(c({id:"products.error.name.required"}));if(!u.price)return O.error(c({id:"products.error.price.required"}));if(!u.qty)return O.error(c({id:"products.error.quantity.required"}));if(!i){const m=await E.detailTempOrdersService.create({title:u.title,qty:u.qty,price:u.price,product:void 0});v({...f,products:[m.data,...f.products]}),f.order||x(m.data,{qty:m.data.qty,size:m.data.size}),t()}if(i){const m=f.products.map(y=>l&&y.id===n.id?{...y,price:u.price,qty:u.qty,title:u.title}:y),w=f.detailOrderProducts.map(y=>d&&y.id===n.id?{...y,total:u.price,quantity:u.qty,title:u.title}:y);v({...f,products:m,detailOrderProducts:w}),f.order||h(p.map(y=>n.id===y.id?{...y,price:u.price,title:u.title,qty:u.qty}:y)),t()}O.success(c({id:"app.save.success"}))};return N.useEffect(()=>{const i=m=>{s&&m.key==="Enter"&&r()};return document.addEventListener("keydown",i),()=>{document.removeEventListener("keydown",i)}},[s,r]),e.jsxs(xe,{showModal:s,onClose:t,title:c({id:n?"orders.title.edit.service":"orders.title.add.service"}),size:"lg",children:[e.jsxs("div",{className:"form-group",children:[e.jsx(_,{className:"font-semibold",children:j("app.title")}),e.jsx("input",{type:"text",className:"form-control",value:u.title,onChange:i=>g({...u,title:i.target.value})})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-4 mb-2",children:[e.jsxs("div",{className:"form-group",children:[e.jsx(_,{className:"font-semibold",children:j("orders.label.price")}),e.jsx(X,{className:"form-control",decimalScale:2,prefix:"$ ",allowNegative:!1,value:u.price,onValueChange:i=>g({...u,price:i.floatValue})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx(_,{className:"font-semibold",children:j("orders.label.qty")}),e.jsx(X,{allowNegative:!1,decimalScale:0,value:u.qty,className:"form-control",onValueChange:i=>g({...u,qty:i.floatValue})})]})]}),e.jsx("div",{children:e.jsxs("button",{onClick:r,className:"btn btn-primary mb-0 w-full btn-sm gap-1.5",type:"button",children:[e.jsx(me,{})," ",j("app.save")]})})]})},ce=a=>{var f,v,u,g,r,i;const{product:s,productOrder:t}=a,[n,d]=N.useState(!1),{formatMessage:l}=R(),{removeCartItem:o}=H(),{values:c,setValues:x}=M(),h=(((f=s==null?void 0:s.product)==null?void 0:f.price)||(t==null?void 0:t.total)||(s==null?void 0:s.price)||0)*((s==null?void 0:s.qty)||(t==null?void 0:t.quantity)||0),p=async()=>{async function m(){try{G(),await E.detailTempOrdersService.deleteOne(s==null?void 0:s.id),x({...c,products:c.products.filter(C=>C.id!==(s==null?void 0:s.id))}),o({...s}),O.success(l({id:"products.deleted.success"}))}catch(C){console.log(C)}finally{Q()}}function w(){x({...c,detailOrderProducts:c.detailOrderProducts.filter(C=>C.id!==t.id&&C.size!==t.size)}),O.success(l({id:"products.deleted.success"}))}(await J.fire({title:l({id:t?"orders.form.delete.product":"orders.form.delete.temporalProduct"}),text:l({id:"app.areYouSureToDoThis"}),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes",cancelButtonText:"No",reverseButtons:!0})).isConfirmed&&(t||m(),t&&w())};return e.jsxs("div",{className:"flex items-center justify-between gap-3 w-full border p-3 border-gray-200 relative",children:[e.jsx("div",{children:e.jsx("span",{className:"text-xs"})}),e.jsx("div",{className:"sm:block hidden",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"block mx-auto w-full text-xs mb-2 font-medium",children:["(",((v=s==null?void 0:s.product)==null?void 0:v.code)||((u=t==null?void 0:t.product)==null?void 0:u.code),")"]}),e.jsx("span",{children:e.jsx("img",{src:s?re(s==null?void 0:s.product):re(t==null?void 0:t.product),className:"sm:w-12 w-8 rounded-lg",alt:""})})]})}),e.jsxs("div",{children:[e.jsxs("h6",{className:"text-sm",children:[((g=s==null?void 0:s.product)==null?void 0:g.title)||((r=t==null?void 0:t.product)==null?void 0:r.title)||(s==null?void 0:s.title)," (",L.format((((i=s==null?void 0:s.product)==null?void 0:i.price)??(t==null?void 0:t.total)??(s==null?void 0:s.price))||0),")"]}),e.jsx(Ps,{...a})]}),e.jsx("div",{className:"text-right flex-grow",children:e.jsx("p",{className:"text-base font-semibold",children:L.format(h)})}),e.jsx(z,{isTrue:!(t!=null&&t.product)&&!(s!=null&&s.product),children:e.jsx("div",{className:"absolute top-1 right-1",children:e.jsxs(es,{placement:"bottom",displayButton:e.jsx(qs,{className:"text-black"}),children:[e.jsxs(ne,{onClick:()=>d(!0),className:"font-semibold flex items-center gap-1",children:[e.jsx(zs,{})," ",j("orders.title.edit.service")]}),e.jsxs(ne,{onClick:p,className:"font-semibold flex items-center gap-1",children:[e.jsx(Je,{})," ",j("orders.title.delete.service")]})]})})}),e.jsx(z,{isTrue:(t==null?void 0:t.product)||(s==null?void 0:s.product),children:e.jsx("div",{className:"absolute top-1 right-1",children:e.jsx(Oe,{onClick:p,className:"text-red-500 cursor-pointer"})})}),e.jsx(z,{isTrue:n,children:e.jsx(be,{isDetailOrderAction:!!t,isProductAction:!!s,showModal:n,onClose:()=>d(!1),detail:t||s})})]})},Os=a=>{var h;const{values:s}=M(),{configEnterprise:t}=he(),n=s.products.reduce((p,f)=>{var v;return p+(((v=f==null?void 0:f.product)==null?void 0:v.price)??f.price)*f.qty},0),d=s.detailOrderProducts.reduce((p,f)=>p+f.total*f.quantity,0),l=s.discount?s.discount/100:0,o=n+d,c=(o*t.iva/100).toFixed(2);let x=o+parseFloat(c);return x=l?x-l*x:x,x===0?null:e.jsx("div",{className:"mt-4",children:e.jsx("table",{className:"table",children:e.jsxs("tfoot",{children:[e.jsxs("tr",{children:[e.jsxs("td",{className:"text-right w-full font-semibold pl-2 pr-4 py-3 text-base",children:[j("orders.label.subtotal"),":"]}),e.jsx("td",{className:"text-center text-base font-semibold",children:L.format(o||0)})]}),e.jsxs("tr",{children:[e.jsxs("td",{className:"text-right font-semibold pl-2 pr-4 py-3 text-base",children:["I.V.A (",((h=s==null?void 0:s.order)==null?void 0:h.iva)||(t==null?void 0:t.iva)||0,"%):"]}),e.jsx("td",{className:"text-center text-base font-semibold",children:L.format(+c)})]}),e.jsx(z,{isTrue:s.discount,children:e.jsxs("tr",{children:[e.jsxs("td",{className:"text-right font-semibold pl-2 pr-4 py-3 text-base",children:[j("orders.label.discount"),":"]}),e.jsxs("td",{className:"text-center text-base font-semibold",children:[s.discount," %"]})]})}),e.jsxs("tr",{children:[e.jsxs("td",{className:"text-right font-semibold pl-2 pr-4 py-3 text-base",children:[j("orders.label.total"),":"]}),e.jsx("td",{className:"text-center text-base font-semibold",children:L.format(+(x||0))})]})]})})})},Vs=a=>{const{values:s}=M();return e.jsx($,{isTrue:!!s.products.length||!!s.detailOrderProducts.length,children:e.jsxs("div",{className:"tile p-3",children:[e.jsxs("div",{className:"flex flex-col items-start gap-3 text-sm",children:[s.products.map(t=>e.jsx(ce,{product:t},t.id)),s.detailOrderProducts.map(t=>e.jsx(ce,{productOrder:t},t.id))]}),e.jsx(Os,{})]})})},Fs=a=>{const{className:s,paymentMethod:t,onClick:n,selected:d}=a,{values:l,setValues:o}=M(),c=()=>{t&&o({...l,paymentMethod:t})};return e.jsxs("div",{className:B(s,"rounded-lg text-sm py-4 sm:py-6 sm:px-8 px-4 overflow-hidden shadow-md flex-grow transition duration-300 md:h-12 h-10 text-center flex items-center justify-center"),onClick:n||c,children:[a.children,e.jsxs($,{isTrue:d,children:[e.jsx("div",{className:"absolute -top-0.5 left-0 w-full h-full flex justify-start items-start",children:e.jsx(Z,{className:"rotate- text-white text-base ml-2.5 shadow-2xl shadow-teal-600"})}),e.jsx("div",{className:"absolute -top-0.5 left-0 w-full h-full flex justify-end items-start",children:e.jsx(Z,{className:"rotate- text-white text-base mr-2.5 shadow-2xl shadow-teal-600"})})]})]})},Ds=a=>{const{className:s}=a,[t,n]=N.useState(!1);return e.jsxs("div",{className:s,children:[e.jsxs(Fs,{onClick:()=>n(!0),className:"bg-white text-black uppercase text-xl font-bold hover:bg-rose-50 cursor-pointer gap-1",children:[e.jsx(ks,{})," ",j("orders.title.add.service")," ",e.jsx(Ts,{})]}),e.jsx(be,{onClose:()=>n(!1),showModal:t})]})},xt=a=>{const{cart:s,order:t}=a,n=Ve(),{setCart:d}=H(),{formatMessage:l}=R(),{configEnterprise:o}=he(),c=Es(),x=N.useRef(),{data:h,isLoading:p}=Ke(),f=h.filter(m=>m.visible),v={status:(t==null?void 0:t.status)||"completed",user:(t==null?void 0:t.user)||null,reference:(t==null?void 0:t.reference)||"",products:s||[],detailOrderProducts:(t==null?void 0:t.detail)||[],paymentMethod:(t==null?void 0:t.paymentMethod)||null,order:t,discount:(t==null?void 0:t.discount)||0},u=async(m,w)=>{c(m)&&(m.order&&g(m),m.order||r(m,w))};async function g(m,w){try{G();const y=m.products.reduce((b,k)=>{var D;return b+(((D=k==null?void 0:k.product)==null?void 0:D.price)??k.price)*k.qty},0),C=m.detailOrderProducts.reduce((b,k)=>b+k.total*k.quantity,0),A=m.discount?m.discount/100:0,S=C+y,P=(S*o.iva/100).toFixed(2);let T=S+parseFloat(P);T=A?T-A*T:T;const q={status:m.status,paymentMethod:m.paymentMethod,reference:m.reference,customer:m.user,detail:[...m.detailOrderProducts.map(b=>{var k;return{id:b.id,quantity:b.quantity,product:b.product,total:b.total,size:b.size,title:b.title||((k=b==null?void 0:b.product)==null?void 0:k.title)}}),...m.products.map(b=>{var k,D;return{quantity:b.qty,product:b.product,total:((k=b==null?void 0:b.product)==null?void 0:k.price)??b.price,size:b.size,title:((D=b==null?void 0:b.product)==null?void 0:D.title)??b.title}})],discount:m.discount,total:T,subtotal:S};await E.ordersService.updateOrder(m.order.idorder,q),J.fire(l({id:"orders.edit.success"}),"","success")}catch(y){console.log(y)}finally{Q()}}async function r(m,w){try{G();const y=m.products.reduce((q,b)=>{var k;return q+(((k=b==null?void 0:b.product)==null?void 0:k.price)??b.price)*b.qty},0),C=m.discount?m.discount/100:0,A=(y*o.iva/100).toFixed(2);let S=y+parseFloat(A);S=C?S-C*S:S;const P={iva:o.iva,customer:m.user,status:m.status,paymentMethod:m.paymentMethod,reference:m.reference,detail:m.products.map(q=>{var b,k;return{quantity:q.qty,product:q.product,total:((b=q==null?void 0:q.product)==null?void 0:b.price)??q.price,size:q.size,title:((k=q.product)==null?void 0:k.title)??q.title}}),discount:m.discount,total:S,subtotal:y},T=await E.ordersService.createOrderBySeller(P);J.fire(l({id:"orders.add.success"}),"","success"),w.resetForm(),w.setFieldValue("products",[]),d([]),n(W.invoiceOrder.fnPath(T.data.idorder))}catch(y){console.log(y)}finally{Q()}}const i=p;return N.useEffect(()=>{i||f.length&&!t&&x.current.setValues({...x.current.values,paymentMethod:f[0]})},[i]),i?e.jsx("div",{className:"p-3 h-full w-full",children:e.jsx(Fe,{loading:!0,className:"w-full bg-white z-50 rounded-md h-full"})}):e.jsx(Ee,{innerRef:x,onSubmit:u,initialValues:v,children:e.jsx(Le,{children:e.jsxs("div",{className:"flex items-start justify-start lg:flex-row flex-col gap-x-4",children:[e.jsxs("div",{className:"lg:max-w-[60%] w-full",children:[e.jsxs("div",{className:"flex items-center flex-wrap gap-x-4",children:[e.jsx("div",{className:"tile mb-2 flex-grow w-auto rounded-md p-3",children:e.jsx(Ns,{})}),e.jsx("div",{className:"tile mb-2 flex-grow w-auto rounded-md p-3",children:e.jsxs("div",{className:"flex items-center relative",children:[e.jsx("span",{className:"text-xs py-2 pl-2.5 pr-2 rounded-l-lg shadow border border-gray-300 bg-gray-200 flex-grow h-[38px] sm:h-[34px] flex items-center justify-center",children:e.jsx(Ge,{})}),e.jsx(Qe,{classNameInput:"form-control form-control-sm pr-9 rounded-l-none",placeholder:j("orders.label.reference"),name:"reference",className:"mb-0 w-full",showError:!1,showSuccess:!1})]})})]}),e.jsx("div",{className:"tile p-3 mb-2",children:e.jsx(As,{})}),e.jsx(Vs,{})]}),e.jsxs("div",{className:"flex flex-col gap-3 items-start justify-start flex-wrap flex-grow",children:[e.jsx(Ds,{className:"w-full flex flex-wrap gap-2"}),e.jsx(Ss,{className:"w-full flex flex-wrap md:gap-3 gap-2",paymentMethods:f}),e.jsx(ws,{className:"w-full flex flex-wrap md:gap-3 gap-2"}),e.jsx(Cs,{className:"flex gap-2 w-full"})]})]})})})},M=()=>fe(),Es=()=>{const{formatMessage:a}=R();return s=>{var t,n;return!((t=s.products)!=null&&t.length)&&!((n=s.detailOrderProducts)!=null&&n.length)?(O.error(a({id:"orders.error.products.required"})),!1):!0}};export{xt as N,mt as P};
