import{j as e,L as S,p as A,k as I,A as F,e as r,l as T,m as U,n as L,v as h,r as s,D as _,q as w,s as f,t as H,R as O,f as Y,_ as D,G as z}from"./index-5d060a31.js";import{H as q}from"./index-dddff9b7.js";import{D as G}from"./DataTable-880fcb59.js";import{u as $}from"./useFetchCategories-8cb0bd86.js";import{a as B}from"./index.esm-68a1f323.js";import{T as J}from"./TablePlaceholder-02f29929.js";import{t as l}from"./translate-df1875a3.js";import"./index-bb9c84f2.js";import"./emotion-is-prop-valid.esm-9ab032ed.js";import"./index-7167fa41.js";import"./formik.esm-d4024a5f.js";import"./react-paginate-3ebe4213.js";import"./useMedia-235a01df.js";import"./useQueryState-744f060d.js";const K=o=>{const{category:t,onDeleteCategory:n,onUpdateCategory:c}=o,i=()=>c(t),d=()=>n(t);return e.jsxs("div",{children:[e.jsx(S,{to:A.viewCategory.fnPath(t.idcategory),className:"btn btn-success btn-xs",children:e.jsx(I,{})}),e.jsxs(F,{validRoles:[r.ValidRoles.ADMIN,r.ValidRoles.SUPER_USER,r.ValidRoles.SUPERVISOR],children:[e.jsx("button",{className:"btn btn-primary btn-xs",onClick:i,children:e.jsx(T,{})}),e.jsx("button",{className:"btn btn-danger btn-xs",onClick:d,children:e.jsx(U,{})})]})]})},Q=o=>o.categories.map(t=>({...t,dateFormatted:L(t.dateCreated).format("DD/MM/YYYY HH:mm:ss"),actions:e.jsx(K,{category:t,...o}),titleFormatted:e.jsx(S,{to:h.viewCategory.fnPath(t.idcategory),className:"link-table",children:t.title})})),W=()=>[{title:l("categories.label.name"),field:"titleFormatted"},{title:l("categories.label.dateCreated"),field:"dateFormatted",center:!0},{title:l("categories.label.actions"),field:"actions",center:!0}],R=s.lazy(()=>_(()=>import("./FormCategory-b0de83b4.js"),["assets/FormCategory-b0de83b4.js","assets/index-5d060a31.js","assets/index-57a2b61b.css","assets/index-a6ad04c6.js","assets/formik.esm-d4024a5f.js","assets/index-830e2dd2.js","assets/label-4820e3e3.js","assets/useTimeOutMessage-1f33819f.js","assets/index.esm-27ddb6fd.js"])),X=s.lazy(()=>_(()=>import("./ModalDeleteCategory-9690d805.js"),["assets/ModalDeleteCategory-9690d805.js","assets/index-5d060a31.js","assets/index-57a2b61b.css","assets/ConfirmModal-61bf492c.js","assets/translate-df1875a3.js"])),Z=o=>{const{formatMessage:t}=w(),[n,c]=s.useState(!1),[i,d]=s.useState(null),[v,p]=s.useState(null),{data:m,setData:g,isFetching:M,refetch:P}=$(),b=f(a=>a.setModal),j=f(a=>a.closeModal),k=a=>{const u=y=>{g(m.map(x=>x.idcategory===y.idcategory?{...x,...y}:x)),j()};b({title:t({id:"categories.edit.title"}),children:e.jsx(s.Suspense,{fallback:e.jsx(e.Fragment,{}),children:e.jsx(R,{category:a,onSuccess:u})}),size:"md"})},E=()=>{const a=u=>{g([u,...m]),j()};b({title:t({id:"categories.add.title"}),children:e.jsx(s.Suspense,{fallback:e.jsx(e.Fragment,{}),children:e.jsx(R,{onSuccess:a})})})},C=()=>{c(!1),d(null)},N=a=>{c(!0),d(a)},V=async()=>{try{p(!0),await Y.categoriesService.deleteCategory(i.idcategory),g(m.filter(a=>a.idcategory!==i.idcategory)),C(),D.success(t({id:"categories.deleted.success"}))}catch(a){console.log(a),D.error(a.response.data.message||t({id:"categories.deleted.error"}))}finally{p(!1)}};return e.jsxs(s.Fragment,{children:[e.jsx(G,{placeholder:e.jsx(J,{}),buttons:e.jsxs("div",{className:"flex items-center justify-start",children:[e.jsx(F,{validRoles:[r.ValidRoles.ADMIN,r.ValidRoles.SUPER_USER,r.ValidRoles.SUPERVISOR],children:e.jsx("button",{className:"btn btn-primary btn-xs",onClick:E,children:e.jsx(H,{})})}),e.jsx("button",{className:"btn btn-outline-alternative btn-xs",onClick:()=>P(),children:e.jsx(B,{})})]}),data:Q({categories:m,onDeleteCategory:N,onUpdateCategory:k}),heading:W(),loading:M}),e.jsx(O,{isTrue:n,children:e.jsx(s.Suspense,{fallback:e.jsx(e.Fragment,{}),children:e.jsx(X,{onAcceptDeleteCategory:V,onCloseModalDelete:C,showModalDeleteCategory:n,category:i,isLoading:v})})})]})},ee=o=>e.jsx(q,{to:h.dashboard.path,title:l("categories.title"),icon:e.jsx(z,{}),breadcrumbs:[{label:l("dashboard.title"),to:h.home.path},{label:l("categories.title")}],children:e.jsx("div",{className:"tile",children:e.jsx(Z,{})})}),he=s.memo(ee);export{he as default};
