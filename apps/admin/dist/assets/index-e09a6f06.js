import{f as h,j as s,g as I,o as O,q as U,u as A,r as m,e as l,w as F,x as L,v as x,_ as M,y as C,b as S,N as T,p as _,z as k,R as q,c as B}from"./index-5d060a31.js";import{H as z}from"./index-dddff9b7.js";import{u as v}from"./useQueryState-744f060d.js";import{T as H}from"./index-7588abf3.js";import{t as a}from"./translate-df1875a3.js";import"./formik.esm-d4024a5f.js";import"./react-paginate-3ebe4213.js";import K from"./index-984e7e33.js";import"./index-fe6bc13a.js";import"./react-tooltip.min-8e0ae1f0.js";/* empty css                */import{c as b}from"./capitalize-1790f93b.js";import $ from"./FormUser-ef302a8b.js";import{S as Q}from"./sweetalert2.all-8c6828e1.js";import{M as W}from"./ModalDeleteUser-9ac860d3.js";import{R as N}from"./index-7167fa41.js";import"./index-bb9c84f2.js";import"./emotion-is-prop-valid.esm-9ab032ed.js";import"./DataTable-880fcb59.js";import"./useMedia-235a01df.js";import"./ActionsTableOrder-e3e2ab6b.js";import"./DropdownItem-83d8cdee.js";import"./index.esm-f872f87b.js";import"./BadgeStatusOrder-a9ca6b7d.js";import"./TablePlaceholder-02f29929.js";import"./index.esm-68a1f323.js";import"./index-5a4cfb67.js";import"./getPrototypeOf-b9d135b5.js";import"./setPrototypeOf-6cb8dd5e.js";import"./unsupportedIterableToArray-cf7d0cbd.js";import"./zIndex-e43e5c8e.js";import"./slicedToArray-efe1abbd.js";import"./index.esm-b3530202.js";import"./utils-d8fef660.js";import"./ExportsBillOrders-795cc4bb.js";import"./index-00fee96b.js";import"./index-4c77f7f5.js";import"./index.esm-8c897c47.js";import"./motion-489fcba6.js";import"./index-a6ad04c6.js";import"./index-830e2dd2.js";import"./label-4820e3e3.js";import"./index-0f2a27c9.js";import"./index.esm-52d18ec2.js";import"./styled-components.browser.esm-b73f4f45.js";import"./emotion-unitless.esm-475d8cc4.js";import"./index-b5d70441.js";import"./index.esm-27ddb6fd.js";import"./useTimeOutMessage-1f33819f.js";import"./ConfirmModal-61bf492c.js";async function G(i){const{queryKey:e}=i,{data:t}=await h.usersService.getUser(e[1]);return t}function J(i){return v(["user",i],G,{})}async function X(i,e){const{data:t}=await h.ordersService.getOrdersByIdUser(i.queryKey[1],{...e||{}});return t}function Y(i,e){return v(["orders-by-user",i],t=>X(t),[])}const Z=i=>{const{id:e}=i,{data:t,setData:d,refetch:c,isFetching:n}=Y(e);return s.jsx(H,{itemsPerPage:10,orders:t,setOrders:d,refetch:c,isFetching:n})},ee=i=>{var R,g;const{user:e,setUser:t}=i,d=I(),{colors:c}=O(),{formatMessage:n}=U(),{user:r}=A(),[w,f]=m.useState(!1),[E,u]=m.useState(!1),[y,j]=m.useState(!1),V=(e.iduser!==r.iduser&&(((e==null?void 0:e.roles.includes(l.ValidRoles.SUPER_USER))||(e==null?void 0:e.roles.includes(l.ValidRoles.ADMIN))||(e==null?void 0:e.roles.includes(l.ValidRoles.SUPERVISOR))||(e==null?void 0:e.roles.includes(l.ValidRoles.SELLER)))&&((R=r==null?void 0:r.roles)==null?void 0:R.includes(l.ValidRoles.SUPER_USER))||((e==null?void 0:e.roles.includes(l.ValidRoles.ADMIN))||(e==null?void 0:e.roles.includes(l.ValidRoles.SUPERVISOR))||(e==null?void 0:e.roles.includes(l.ValidRoles.SELLER)))&&(r==null?void 0:r.roles.includes(l.ValidRoles.ADMIN))||((e==null?void 0:e.roles.includes(l.ValidRoles.SUPERVISOR))||(e==null?void 0:e.roles.includes(l.ValidRoles.SELLER)))&&(r==null?void 0:r.roles.includes(l.ValidRoles.SUPERVISOR)))||(e==null?void 0:e.roles.includes(l.ValidRoles.USER)))&&!(e!=null&&e.roles.includes(l.ValidRoles.SUPER_USER)),D=(g=r==null?void 0:r.roles)==null?void 0:g.some(o=>o===l.ValidRoles.ADMIN||o===l.ValidRoles.SUPER_USER||o===l.ValidRoles.SUPERVISOR),P=async()=>{try{j(!0),await h.usersService.deleteUser(e.iduser),d(x.users.path),u(!1),Q.fire(n({id:"users.deleted.success"}),"","success")}catch(o){console.log(o),M.error(o.response.data.message||n({id:"users.deleted.error"}))}finally{j(!1)}};return s.jsxs(m.Fragment,{children:[s.jsx("div",{className:"tile",children:s.jsx("div",{className:"flex flex-col xl:flex-row gap-4",children:s.jsx("div",{children:s.jsxs("div",{className:"flex flex-col xl:justify-between h-full 2xl:min-w-[360px] mx-auto",children:[s.jsxs("div",{className:"flex xl:flex-col items-center gap-4",children:[s.jsx("img",{alt:"...",src:"https://demos.creative-tim.com/notus-js/assets/img/team-2-800x800.jpg",className:"shadow-xl rounded-full h-12 align-middle border-none w-12"}),s.jsx("h6",{className:"font-bold",children:b(e==null?void 0:e.firstName)+" "+b(e==null?void 0:e.lastName)})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-1 gap-y-2 gap-x-4 mt-8",children:[s.jsx(p,{title:"ID",value:e==null?void 0:e.iduser}),s.jsx(N,{isTrue:e==null?void 0:e.dni,children:s.jsx(p,{title:"DNI",value:(e!=null&&e.prefix&&c.enablePrefixesUser?(e==null?void 0:e.prefix)+" ":null)+(e==null?void 0:e.dni)})}),s.jsx(p,{title:"Email",value:e==null?void 0:e.email}),s.jsx(p,{title:"Phone",value:e==null?void 0:e.phone})]}),s.jsx(N,{isTrue:V,children:s.jsxs("div",{className:"mt-4 flex flex-col xl:flex-row gap-2",children:[s.jsxs("button",{type:"button",onClick:()=>u(!0),className:"btn btn-outline-danger btn-sm w-full gap-1 mb-0",children:[a("app.delete")," ",s.jsx(F,{})]}),s.jsxs("button",{type:"button",onClick:()=>f(!0),className:"btn btn-primary btn-sm w-full gap-1 mb-0",children:[a("app.edit")," ",s.jsx(L,{})]})]})})]})})})}),s.jsx(K,{title:s.jsx("span",{className:"text-lg font-bold",children:a("users.edit")}),width:290,onClose:()=>f(!1),isOpen:w,children:s.jsx($,{user:e,fullWidthDni:!0,renderRoles:D,onSuccess:o=>{f(!1),t(o)}})}),s.jsx(W,{isLoading:y,user:e,showModalDeleteUser:E,onAcceptDeleteUser:P,onCloseModalDelete:()=>u(!1)})]})},p=i=>{const{title:e,value:t}=i;return s.jsxs("div",{children:[s.jsx("span",{className:"font-bold",children:e}),s.jsx("p",{className:"text-gray-700 dark:text-gray-200 font-semibold text-sm",children:t})]})},se=i=>{U();const e=C(),{data:t,isFetching:d,setData:c,error:n}=J(e.id);return d?s.jsx(S,{loading:!0}):!Object.keys(t).length&&n?s.jsx(T,{to:_.users.path}):Object.keys(t).length?s.jsx(z,{to:x.users.path,title:a("users.single"),icon:s.jsx(k,{}),breadcrumbs:[{label:a("dashboard.title"),to:x.home.path},{label:a("users.title"),to:x.users.path},{label:t!=null&&t.firstName?(t==null?void 0:t.firstName)+" "+(t==null?void 0:t.lastName):a("users.single")}],children:s.jsxs("div",{className:"flex flex-col xl:flex-row gap-4",children:[s.jsx("div",{children:s.jsx(ee,{user:t,setUser:c})}),s.jsx("div",{className:"w-full",children:s.jsx(q,{isTrue:!0,children:s.jsxs("div",{className:B("tile"),children:[s.jsx("h6",{className:"mb-4",children:a("orders.title")}),s.jsx(Z,{id:e.id})]})})})]})}):s.jsx(S,{loading:!0})},Ye=m.memo(se);export{Ye as default};
