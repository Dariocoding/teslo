import{j as e,c as D,a as v,r as f,R,h as U,a4 as q,U as z,V as H}from"./index-2a44fdcc.js";import{R as V}from"./index-bc927370.js";import{g as M}from"./formik.esm-9f82e298.js";import{R as Q}from"./react-paginate-2e6e26f6.js";import{u as K}from"./useMedia-7838bc79.js";import Z from"./index-bae43588.js";import"./index-b897be0f.js";import"./react-tooltip.min-0bea07f1.js";/* empty css                */import{t as G}from"./translate-b34db3f3.js";import{T as J}from"./TablePlaceholder-9eafa574.js";import{T as W}from"./index-5f7fbb69.js";import{u as X}from"./useFetchProducts-236b8cf1.js";import{u as Y}from"./useFetchCategories-8370e35c.js";import{u as _}from"./useFetchBrands-5425de56.js";const ee=s=>{const{result:t,onClickResult:a,selected:r,refSelected:o}=s;return e.jsx("div",{className:D("search-result text-sm cursor-pointer transition whitespace-normal",r&&"bg-gray-100"),onClick:l=>a(t.value),ref:r?o:null,children:t.label})},te=s=>{const{results:t,selected:a,setSelected:r,onClickResult:o,refContainer:l}=s,[d,m]=v.useState(null),i=v.useRef(null),n=v.useCallback(()=>{const u=d,g=u.getBoundingClientRect(),c=i.current.getBoundingClientRect().top-g.top+u.scrollTop-100;u.scrollTo({top:c,behavior:"smooth"})},[a,d]);v.useEffect(()=>{function u(g){if(t.length===0)return;const h=g.key;let x;if((h==="ArrowUp"||h==="ArrowDown")&&(x=t.map(c=>c.value).indexOf(a.value),x===-1&&r(t[0])),h==="ArrowUp"){const c=t[x-1];c&&(r(c),n())}else if(h==="ArrowDown"){const c=t[x+1];c&&(r(c),n())}h==="Enter"&&o(a.value)}return window.addEventListener("keydown",u),()=>{window.removeEventListener("keydown",u)}},[t,n]);const j=v.useCallback(()=>{const u=l.current,g=d;if(u&&g){const h=u.getBoundingClientRect(),x=g.getBoundingClientRect();if(window.innerHeight>x.bottom){const c="transform: translate3d(0px, 0px, 0) !important;";g.setAttribute("style",c)}else if(x.bottom>window.innerHeight){const k=`transform: translate3d(0px, -${h.height+x.height+10}px, 0) !important;`;g.setAttribute("style",k)}}},[d]);return v.useEffect(()=>(j(),window.addEventListener("resize",j),()=>{window.removeEventListener("resize",j)}),[j]),{refSelected:i,setRefPanel:m}},se=s=>{const{results:t,classNameContainer:a,selected:r,onClickResult:o}=s,{refSelected:l,setRefPanel:d}=te({...s});return e.jsx(V,{isTrue:t.length,children:e.jsx("div",{className:D("absolute z-50 w-full",a),children:e.jsx("div",{className:"results-list",ref:d,children:t.map((m,i)=>e.jsx(ee,{result:m,onClickResult:o,selected:(r==null?void 0:r.value)===m.value,refSelected:l},i))})})})},ye=s=>{const{onFocus:t,onBlur:a,focused:r}=s,o=f.useRef();return e.jsxs("div",{className:"container-input-code relative",onBlur:a,onFocus:t,ref:o,children:[s.children,e.jsx(R,{isTrue:r,children:e.jsx(se,{...s,refContainer:o})})]})},ne=s=>{const{categories:t,brands:a,q:r,setQ:o}=s,{setBrandSelected:l,setCategorySelected:d,brandSelected:m,categorySelected:i}=s;return e.jsxs(f.Fragment,{children:[e.jsx("div",{className:"mb-2",children:e.jsx("input",{type:"text",value:r,onChange:n=>o(n.target.value),className:"form-control form-control-sm"})}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-4",children:[e.jsxs("select",{className:"form-control sm:text-sm text-xs px-2 py-2",value:m,onChange:n=>l(n.target.value),children:[e.jsx("option",{value:"",children:"No Brand"}),a.map(n=>e.jsx("option",{value:n.idbrand,children:n.title},n.idbrand))]}),e.jsxs("select",{className:"form-control sm:text-sm text-xs px-2 py-2",value:i,onChange:n=>d(n.target.value),children:[e.jsx("option",{value:"",children:"No Category"}),t.map(n=>e.jsx("option",{value:n.idcategory,children:n.title},n.idcategory))]})]})]})},re=s=>{const{product:t,handleClick:a,showPriceTooltip:r=!0}=s;return e.jsx(W,{message:U.format(t.price),className:"block h-full",onClick:()=>a(t),children:e.jsx(ae,{product:t})})},ae=({product:s,onClick:t})=>e.jsxs("div",{onClick:t,className:"border border-gray-300 rounded-lg p-2 transition hover:bg-gray-200 cursor-pointer flex items-center gap-x-3",children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("img",{src:q(s),alt:s.title,className:"max-w-[40px] max-h-[40px] rounded-full object-cover"})}),e.jsxs("p",{className:"leading-[0.85rem] text-sm",children:[s.title," ",e.jsxs("span",{className:"text-xs",children:["(",s.stock,")"]})]})]}),oe=s=>{const{page:t,pageCount:a,setItemOffset:r,setPage:o,items:l,itemsPerPage:d}=s,m=i=>{const n=i.selected*d%l.length;r(n),o(i.selected)};return e.jsx(Q,{nextLabel:e.jsx(z,{}),onPageChange:m,pageRangeDisplayed:1,pageCount:a,previousLabel:e.jsx(H,{}),renderOnZeroPageCount:null,pageClassName:"",pageLinkClassName:"btn shadow-none sm:block hidden btn-outline-primary btn-xs",previousClassName:"",previousLinkClassName:"btn shadow-none btn-primary btn-xs px-2",nextClassName:"",nextLinkClassName:"btn shadow-none btn-primary btn-xs px-2",breakLabel:"...",breakClassName:"btn shadow-none sm:block hidden btn-xs btn-outline-primary",breakLinkClassName:"",containerClassName:"flex justify-center items-center",activeClassName:"",activeLinkClassName:"btn shadow-none btn-primary btn-xs",forcePage:t})},ce=s=>{const{sm:t,onClickProductDrawer:a,showPriceTooltip:r}=s,o=t?6:18,[l,d]=f.useState(""),[m,i]=f.useState(0),[n,j]=f.useState(0),[u,g]=f.useState(0),[h,x]=f.useState([]),[c,k]=f.useState(""),[w,E]=f.useState(""),{data:y,isLoading:O}=X(),{data:B,isLoading:I}=Y(),{data:F,isLoading:A}=_(),T=A||I||O;f.useEffect(()=>{(()=>{const L=u+o,C=$(y),b=Math.ceil(C.length/o),P=C.slice(u,L),N=b?m+1:0;if(x(P),j(b),N>b){const S=(b-1)*o%y.length;g(S),i(b-1)}})()},[u,y,l,c,w,t]);const $=p=>{c&&(p=p.filter(C=>C.brand.idbrand===c)),w&&(p=p.filter(C=>C.categories.some(b=>b.idcategory===w)));const L=p[0]&&Object.keys(p[0]);return p.filter(C=>L.some(b=>{var P,N,S;return((S=(N=(P=M(C,b))==null?void 0:P.toString())==null?void 0:N.toLowerCase())==null?void 0:S.indexOf(l.toLowerCase().trim()))>-1}))};return e.jsxs(f.Fragment,{children:[e.jsx(R,{isTrue:T,children:e.jsx(J,{})}),e.jsxs(R,{isTrue:!T,children:[e.jsx(ne,{brands:F,categories:B,q:l,setQ:d,setBrandSelected:k,setCategorySelected:E,brandSelected:c,categorySelected:w}),e.jsx("div",{className:"grid sm:grid-cols-3 gap-2",children:h.map(p=>e.jsx(re,{product:p,handleClick:a,showPriceTooltip:r},p.id))}),e.jsx("div",{className:"mt-3",children:e.jsx(oe,{page:m,pageCount:n,items:y,itemsPerPage:o,setPage:i,setItemOffset:g})})]})]})},Pe=s=>{const{showDrawerProducts:t,setShowDrawerProducts:a,onClickProductDrawer:r,showPriceTooltip:o}=s,l=K("(max-width: 700px)"),d=l?290:700;return f.useEffect(()=>{const m=i=>{const n=i.target||{};(n==null?void 0:n.nodeName)!=="INPUT"&&i.key==="p"&&a(!t)};return document.addEventListener("keydown",m),()=>{document.removeEventListener("keydown",m)}},[t]),e.jsx(Z,{overlayClassName:"bg-black bg-opacity-25",width:d,shouldCloseOnOverlayClick:!1,isOpen:t,onClose:()=>a(!1),placement:"left",title:e.jsxs("span",{className:"text-xl font-semibold",children:[G("products.title")," "]}),bodyClass:"p-3",children:e.jsx(ce,{sm:l,onClickProductDrawer:r,showPriceTooltip:o})})};export{Pe as D,ye as S};
